<div class="row">
	<div class="col-md-12 m-b-30">
		<!-- begin page title -->
		<div class="d-block d-lg-flex flex-nowrap align-items-center">
			<div class="page-title mr-4 pr-4 border-right">
				<h1>Bán hàng</h1>
			</div>

			<!-- <div
				class="ml-auto d-flex align-items-center secondary-menu text-center">
				<button type="button" class="btn btn-primary" ng-click="reset()"
					data-toggle="modal" data-target="#largeModal">Thêm tài
					khoản</button>
			</div> -->
		</div>
		<!-- end page title -->
	</div>
</div>
<!-- end row -->
<!-- begin row -->
<div class="row">
	<div class="col-md-7">
		<div class="card card-statistics">
			<div class="card-header" style="max-height: 200px; overflow-y: auto;">
				<div class="card-heading">
					<div class="row">
						<div class="col-md-12">
							<form class="justify-content-end">
								<div class="form-group">
									<input ng-model="keyword" oninput="angular.element(this).scope().search(this.value)"
										type="text" class="form-control" placeholder="Tìm sản phẩm">
								</div>
							</form>

						</div>
					</div>
					<div ng-repeat="p in results" class="row">
						<div class="col-md-3 m-0 p-0 text-center justify-content-center">
							<img class="" ng-src="/images/product/{{p.photo}}" width="60%" alt="">
							<div class="product-labels rectangular">
								<span ng-if="p.discount > 0" class="lbl on-sale">-{{p.discount}} %</span>
								<span ng-if="p.rx" class="lbl bg-primary">Rx</span>
								<span ng-if="p.conHang == false" class="lbl bg-warning">Hết hàng</span>

							</div>
						</div>
						<div class="col-md-9 m-0 p-0">
							<form action="">
								<div class="form-group">
									<label for="">{{p.name}}</label><br>
									<div class="product-price">
										<span ng-if="p.discount" class="old-price">{{p.price |number:0}}</span>
										<span class="price">{{p.price - (p.price * p.discount/100)
											|number:0}}/{{p.util}} </span>
									</div>
								</div>
								<!-- <div class="form-group">
								</div> -->
								<div class="form-group">
									<button ng-disabled="p.conHang == false" ng-click="sell.add(p.goodsId, p.discount)"
										class="btn btn-addto-cart" type="button">Add</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="card-body">
				<div class="card-header">
					<div class="card-heading">
						<div class="row">
							<div class="col-md-12">
								<h4>Giỏ hàng</h4>
							</div>
						</div>
					</div>
				</div>
				<div class="table-responsive">
					<table class="table table-hover table-bordered">
						<thead class="thead-light">
							<tr>
								<th scope="col">#</th>
								<th scope="col">Hình ảnh</th>
								<th scope="col">Tên sản phẩm</th>
								<th scope="col">Đơn giá</th>
								<th scope="col">Số lượng</th>
								<th scope="col">Tổng tiền</th>
								<th scope="col"></th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="s in sell.items">
								<th scope="row">{{s.id}}</th>
								<td><img ng-src="/images/product/{{s.product.photo}}" width="50%" alt=""></td>
								<td class="un-white-space"
									style="word-wrap: break-word;min-width: 100px;max-width: 100px; vertical-align: middle">
									{{s.product.name}}</td>
								<td>{{s.giaBan - (s.giaBan * s.discount/100)
									|number:0}}/{{s.util.name}} </td>
								<td><input style="min-width: 50px;max-width: 50px" ng-change="sell.saveToLocalStorage()"
										ng-model="s.qty" min="1" type="number" id="Quantity" name="quantity"
										class="product-form__input qty"></td>
								<td>{{sell.priceItem(s.id) | number: 0}}</td>
								<td class="text-right">
									<button ng-click="sell.remove(s.id)" class="btn btn-dark">
										<i class="fa-solid fa-circle-xmark"></i>
									</button>

								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-5">
		<div class="card card-statistics">
			<div class="card-header" style="max-height: 200px; overflow-y: auto;">
				<div class="card-heading">
					<h4>Thông tin khách hàng</h4>
				</div>
			</div>
			<div class="card-body">
				<form action="">
					<div class="row">
						<div class="form-group col">
							<input class="form-control" type="text"
								oninput="angular.element(this).scope().searchCustomer(this.value)"
								placeholder="Tìm khách hàng" name="search">
						</div>
					</div>
					<div style="max-height: 200px; overflow-y: auto;" class="row">
						<div ng-repeat="c in customers" class="row">
							<div class="col-md-3 m-0 p-0 text-center justify-content-center">
								<img class="" ng-src="/images/account/{{c.avatar}}" width="60%" alt="">
							</div>
							<div class="col-md-8 m-0 p-0">
								<form action="">
									<div class="form-group">
										<label for=""><b>Họ tên: </b>{{c.hoTen}}</label><br>
										<label for=""><b>Email: </b>{{c.email}}</label><br>
										<label for=""><b>Giới tính: </b>{{c.gioiTinh?'Nam':'Nữ'}}</label><br>
									</div>
									<!-- <div class="form-group">
								</div> -->
									<div class="form-group">
										<button ng-click="addCustomer(c.email)" class="btn btn-addto-cart"
											type="button">Add</button>
									</div>
								</form>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group col-md-6">
							<label for="maDS">Mã DS:</label>
							<input class="form-control" type="text" ng-model="currentAccount.email" disabled
								name="maDS">
						</div>
						<div class="form-group col-md-6">
							<label for="tenNV">Tên DS:</label>
							<input class="form-control" type="text" ng-model="currentAccount.hoTen" disabled
								name="tenNV">
						</div>
					</div>
					<div class="row">
						<div class="form-group col-md-6">
							<label for="maKH">Mã KH:</label>
							<input class="form-control" type="text" ng-model="customer.email" disabled name="maKH">
						</div>
						<div class="form-group col-md-6">
							<label for="tenKH">Tên KH:</label>
							<input class="form-control" type="text" ng-model="customer.hoTen" disabled name="tenKH">
						</div>

					</div>
					<div class="row">
						<div class="form-group col-md-6">
							<label for="gioiTinh">Giới tính:</label>
							<input class="form-control" type="text" ng-model="customer.gioiTinh?'Nam':'Nữ'" disabled
								name="gioiTinh">
						</div>
						<div class="form-group col-md-6">
							<label for="diem">Điểm tích lũy:</label>
							<input class="form-control" type="text" ng-model="customer.diem" disabled name="diem">
						</div>
					</div>
					<div class="row">
						<div class="form-group col">
							<label for="sdt">Sdt:</label>
							<input class="form-control" type="text" ng-model="customer.sdt" name="sdt">
						</div>
					</div>
					<div class="row">
						<div class="form-group col">
							<label for="chuanDoan">Chuẩn đoán</label>
							<input type="text" class="form-control" ng-model="customer.ghiChu" name="chuanDoan">
						</div>
					</div>
					<div class="row">
						<div class="form-group ml-2 form-check">
							<input type="checkbox" ng-model="giaoHang" class="form-check-input" id="exampleCheck1">
							<label class="form-check-label" for="exampleCheck1">Giao hàng</label>
						</div>
					</div>
					<div ng-if="giaoHang">
						<div class="row">
							<div class="form-group col-md-4">
								<label for="tinh">Tỉnh:</label>
								<select onchange="angular.element(this).scope().getQuan(this.value)" ng-model="diaChi.tinh" class="form-control">
									<option value="">Chọn tỉnh</option>
									<option ng-repeat="tinh in lstTinh" ng-value="tinh.ProvinceID">{{tinh.ProvinceName}}
									</option>
								</select>
							</div>
							<div class="form-group col-md-4">
								<label for="tinh">Quận:</label>
								<select onchange="angular.element(this).scope().getPhuong(this.value)" ng-disabled="diaChi.tinh == '' || diaChi.tinh == null" ng-model="diaChi.quan" class="form-control">
									<option value="null">Chọn quận</option>
									<option ng-repeat="quan in lstQuan" ng-value="quan.DistrictID">{{quan.DistrictName}}
									</option>
								</select>
							</div>
							<div class="form-group col-md-4">
								<label for="xa">Phường:</label>
								<select  ng-disabled="diaChi.quan == '' || diaChi.quan == null" ng-model="diaChi.phuong" class="form-control">
									<option value="0">Chọn phường</option>
									<option ng-repeat="phuong in lstPhuong" ng-value="phuong.WardCode">{{phuong.WardName}}
									</option>
								</select>
							</div>

						</div>
						<div class="row">
							<div class="form-group col">
								<label for="diaChi">Địa chỉ:</label>
								<input class="form-control" type="text" ng-model="customer.diaChi" name="diaChi">
							</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group col">
							<label for="tongTien">Tổng tiền:</label>
							<input class="form-control font-weight-bold text-danger" type="text" disabled
								ng-model="sell.amount | number: 0" name="tongTien">
						</div>
					</div>
					<button ng-disabled="giaoHang ||customer.email == NaN || sell.amount == 0" ng-click="banHang()"
						class="btn btn-dark">Bán hàng</button>
					<button ng-disabled="!giaoHang" class="btn btn-dark">Giao hàng</button>
				</form>
			</div>
		</div>
	</div>
</div>
<!-- Large Modal -->
<div class="modal fade" id="largeModal" tabindex="-1" role="dialog" aria-labelledby="largeModal" aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Thông tin tài khoản {{account.email}}</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-md-4 text-center">
						<label> <img ng-src="/images/account/{{account.avatar}}" class="logo" alt="">
						</label>
					</div>
					<div class="col-md-8">
						<form name="frmAccount">
							<div class="row mt-2">
								<div class="col">
									<label>Email</label> <input name="email" ng-model="account.email" required
										type="email" ng-disabled="chon == true" class="form-control">
									<div ng-show="frmAccount.email.$invalid" class="badge badge-danger m-2">Email không
										đúng</div>
								</div>
								<div class="col">
									<label>Họ tên</label> <input name="hoTen" ng-model="account.hoTen" required
										type="text" class="form-control">
									<div ng-show="frmAccount.hoTen.$invalid" class="badge badge-danger m-2">Họ tên không
										được để
										trống</div>
								</div>
							</div>
							<div class="row mt-2">
								<div class="col">
									<label>Ngày sinh</label> <input name="ngaySinh" ng-model="account.ngaySinh" required
										type="text" class="form-control" placeholder="yyyy-mm-dd" validate_day>
									<div ng-show="frmAccount.ngaySinh.$invalid" class="badge badge-danger m-2">Ngày sinh
										phải có dạng
										yyyy-mm-dd</div>
								</div>
								<div class="col">
									<label>Sđt</label> <input name="sdt" ng-model="account.sdt" required type="text"
										class="form-control" validate_sdt>
									<div ng-show="frmAccount.sdt.$invalid" class="badge badge-danger m-2">Sdt không đúng
									</div>
								</div>
							</div>
							<div class="row mt-2">
								<div class="col">
									<label>Ngày tạo</label> <input name="ngayTao" ng-model="account.ngayTao" required
										type="text" class="form-control" placeholder="yyyy-mm-dd" validate_day>
									<div ng-show="frmAccount.ngayTao.$invalid" class="badge badge-danger m-2">Ngày tạo
										phải có dạng
										yyyy-mm-dd</div>
								</div>
								<div class="col">
									<label>Điểm tích lũy</label> <input name="diem" ng-model="account.diem" ng-min="0"
										required type="number" class="form-control">
									<div ng-show="frmAccount.diem.$invalid" class="badge badge-danger m-2">Điểm phải lớn
										hơn hoặc
										bằng 0</div>
								</div>
							</div>
							<div class="row mt-2">
								<div class="col">
									<label>Mật khẩu</label> <input name="matKhau" ng-model="account.matKhau" required
										type="password" class="form-control">
								</div>
								<div class="col">
									<label>Avatar</label>
									<div class="custom-file">
										<input type="file" accept="image/*" class="custom-file-input"
											onchange="angular.element(this).scope().imageChanged(this.files)" />
										<label class="custom-file-label">Choose file</label>
									</div>
								</div>
							</div>
							<div class="row mt-2">
								<div class="col">
									<label>Vai trò</label> <select ng-model="account.role.id" class="form-control">
										<option ng-repeat="role in roles" ng-value="role.id">{{role.name}}
										</option>
									</select>
								</div>
								<div class="col">
									<label class="mr-2">Giới tính</label> <br>
									<div class="form-check-inline">
										<input ng-model="account.gioiTinh" class="form-check-input" type="radio"
											name="gioiTinh" ng-value="true"> <label class="form-check-label"> Nam
										</label>
									</div>
									<div class="form-check-inline">
										<input ng-model="account.gioiTinh" class="form-check-input" type="radio"
											name="gioiTinh" ng-value="false"> <label class="form-check-label">Nữ
										</label>
									</div>
								</div>
								<div class="col">
									<label class="mr-2">Hoạt động</label> <br>
									<div class="form-check-inline">
										<input ng-model="account.active" class="form-check-input" type="radio"
											name="active" ng-value="true"> <label class="form-check-label"> Yes </label>
									</div>
									<div class="form-check-inline">
										<input ng-model="account.active" class="form-check-input" type="radio"
											name="active" ng-value="false"> <label class="form-check-label">No </label>
									</div>
								</div>
							</div>
							<div class="form-group">
								<label>Ghi chú</label>
								<textarea ng-model="account.ghiChu" class="form-control" rows="3"></textarea>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button ng-disabled="frmAccount.$invalid || chon == true" ng-click="create()"
					class="btn btn-primary">Create</button>
				<button ng-disabled="frmAccount.$invalid || chon == false" ng-click="update(account.email)"
					class="btn btn-info">Update</button>
				<button ng-click="reset()" class="btn btn-secondary">Reset</button>
				<button ng-disabled="chon == false" ng-click="delete(account.email)"
					class="btn btn-dark">Delete</button>
			</div>
		</div>
	</div>
</div>